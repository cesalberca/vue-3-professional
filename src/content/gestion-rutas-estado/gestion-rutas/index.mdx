import Exercise from './definiendo-router/Exercise.vue'

# 🛣️ Gestión de Rutas con Vue Router 4

Vue Router 4 representa una evolución significativa respecto a Vue Router 3, diseñado específicamente para Vue 3. En esta sección nos centraremos en las **principales diferencias** que necesitas conocer para migrar exitosamente.

## 🔄 Principales diferencias entre Vue Router v3 y v4

### 1. 🚀 **Inicialización**

**Vue Router 3:**

```javascript
import Vue from 'vue'
import VueRouter from 'vue-router'

Vue.use(VueRouter)

const router = new VueRouter({
  mode: 'history',
  routes,
})

new Vue({
  router,
  render: h => h(App),
}).$mount('#app')
```

**Vue Router 4:**

```javascript
import { createApp } from 'vue'
import { createRouter, createWebHistory } from 'vue-router'

const router = createRouter({
  history: createWebHistory(),
  routes,
})

const app = createApp(App)
app.use(router)
app.mount('#app')
```

### 2. 📂 **Cambio en la opción base**

**Vue Router 3:**

```javascript
const router = new VueRouter({
  base: process.env.BASE_URL,
  routes,
})
```

**Vue Router 4:**

```javascript
const router = createRouter({
  history: createWebHistory(process.env.BASE_URL),
  routes,
})
```

### 3. 📚 **History**

**Vue Router 3:**

```javascript
const router = new VueRouter({
  mode: 'history', // o 'hash'
  routes,
})
```

**Vue Router 4:**

```javascript
import {
  createWebHistory, // reemplaza mode: 'history'
  createWebHashHistory, // reemplaza mode: 'hash'
  createMemoryHistory, // para SSR
} from 'vue-router'

const router = createRouter({
  history: createWebHistory(),
  routes,
})
```

### 4. ❌ **Quitada la opción fallback**

**Vue Router 3:**

```javascript
const router = new VueRouter({
  mode: 'history',
  fallback: false, // ❌ Ya no existe en v4
  routes,
})
```

**Vue Router 4:**

```javascript
// La opción fallback se maneja ahora automáticamente
// según el entorno (browser vs SSR)
const router = createRouter({
  history: createWebHistory(),
  routes,
})
```

### 5. 🔍 **Quitada \* (star o catch-all routes)**

**Vue Router 3:**

```javascript
const routes = [
  // Catch-all route
  { path: '*', component: NotFound },
]
```

**Vue Router 4:**

```javascript
const routes = [
  // Nueva sintaxis para catch-all
  { path: '/:pathMatch(.*)*', name: 'NotFound', component: NotFound },
]
```

### 6. 📍 **La propiedad currentRoute ahora es un ref()**

**Vue Router 3:**

```javascript
// currentRoute era un objeto reactivo simple
console.log(router.currentRoute.name)

// En componentes
export default {
  computed: {
    currentRouteName() {
      return this.$route.name
    },
  },
}
```

**Vue Router 4:**

```javascript
// currentRoute es ahora un ref()
console.log(router.currentRoute.value.name)

// En componentes con Composition API
import { computed } from 'vue'
import { useRoute } from 'vue-router'

export default {
  setup() {
    const route = useRoute()

    const currentRouteName = computed(() => route.name)

    return { currentRouteName }
  },
}
```

### 7. ⏱️ **Replaced onReady with isReady**

**Vue Router 3:**

```javascript
router.onReady(() => {
  console.log('Router is ready!')
})
```

**Vue Router 4:**

```javascript
// onReady() ya no existe, ahora es async
router.isReady().then(() => {
  console.log('Router is ready!')
})

// O usando async/await
await router.isReady()
console.log('Router is ready!')
```

### 8. 📜 **scrollBehavior changes**

**Vue Router 3:**

```javascript
const router = new VueRouter({
  scrollBehavior(to, from, savedPosition) {
    if (savedPosition) {
      return savedPosition
    } else {
      return { x: 0, y: 0 }
    }
  },
})
```

**Vue Router 4:**

```javascript
const router = createRouter({
  scrollBehavior(to, from, savedPosition) {
    if (savedPosition) {
      return savedPosition
    } else {
      // Cambió la estructura del objeto retornado
      return { left: 0, top: 0 }
    }
  },
})

// También soporta async scrollBehavior
const router = createRouter({
  scrollBehavior(to, from, savedPosition) {
    return new Promise(resolve => {
      setTimeout(() => {
        resolve({ left: 0, top: 0 })
      }, 500)
    })
  },
})
```

### 9. 🎭 **`<router-view>`, `<keep-alive>`, y `<transition>`**

**Vue Router 3:**

```vue
<template>
  <transition name="fade">
    <keep-alive>
      <router-view />
    </keep-alive>
  </transition>
</template>
```

**Vue Router 4:**

```vue
<template>
  <!-- Ahora router-view expone el componente y route -->
  <router-view v-slot="{ Component, route }">
    <transition name="fade" mode="out-in">
      <keep-alive>
        <component :is="Component" :key="route.path" />
      </keep-alive>
    </transition>
  </router-view>
</template>
```

## 🎯 **Resumen de migración**

| Concepto            | Vue Router 3          | Vue Router 4                         |
| ------------------- | --------------------- | ------------------------------------ |
| **Creación**        | `new VueRouter()`     | `createRouter()`                     |
| **History**         | `mode: 'history'`     | `createWebHistory()`                 |
| **Base URL**        | `base: '/app/'`       | `history: createWebHistory('/app/')` |
| **Catch-all**       | `path: '*'`           | `path: '/:pathMatch(.*)*'`           |
| **Route actual**    | `router.currentRoute` | `router.currentRoute.value`          |
| **Router ready**    | `router.onReady()`    | `await router.isReady()`             |
| **Scroll position** | `{ x: 0, y: 0 }`      | `{ left: 0, top: 0 }`                |
| **Fallback**        | `fallback: false`     | ❌ Eliminado                         |

## 🚀 **Beneficios de Vue Router 4**

- ✅ **Mejor tree-shaking**: Bundle más pequeño
- ✅ **TypeScript nativo**: Tipos incluidos de fábrica
- ✅ **Composition API**: Integración perfecta con `useRouter()` y `useRoute()`
- ✅ **API más consistente**: Menos confusión entre conceptos
- ✅ **Mejores herramientas de desarrollo**: DevTools mejoradas

---

¡En los ejercicios pondremos en práctica todos estos conceptos de migración!

---
